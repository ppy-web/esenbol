<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>果然新鲜</title>
    <link rel="shortcut icon" href="./images/icon.png" type="image/x-icon">
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/common.css">
    <link rel="stylesheet" href="./layui/css/layui.css">
    <script src="./layui/layui.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <style>
        .layui-container {
            margin-top: 70px;
            background: rgb(255, 255, 255);
        }
    </style>
</head>

<body>
    <!-- 导航条 -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="glyphicon glyphicon-option-vertical"></span>
                </button>
                <img src="./images/logo.png">
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li><a href="#">首&nbsp;&nbsp;&nbsp;&nbsp;页</a></li>
                    <li><a href="#">蔬果热卖</a></li>
                    <li><a href="#">全部产品</a></li>
                    <li><a href="#">行业资讯</a></li>
                    <li><a href="#">联系我们</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                            aria-expanded="false">购物车<span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="#">Action</a></li>
                            <li><a href="#">Another action</a></li>
                        </ul>
                    </li>
                </ul>

                <ul class="nav navbar-nav navbar-right">
                    <button type="button" class="btn btn-default navbar-btn" data-toggle="modal"
                        data-target="#myModal">登录</button>
                    <a href="./register.html" class="btn btn-default" role="button">注册</a>


                </ul>
            </div><!-- /.navbar-collapse -->

        </div><!-- /.container-fluid -->
    </nav>
    <!-- 模态框 -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">欢迎登录</h4>
                </div>
                <div class="modal-body">
                    <form action="">
                        <div class="form-group">
                            <label for="">用户名:</label>
                            <input type="text" class="form-control" style="color:red;">
                        </div>
                        <div class="form-group">
                            <label for="">密码</label>
                            <input type="password" class="form-control" style="color:red;">
                        </div>
                        <div class="form-group">
                            <input type="submit" value="登陆" class="btn btn-success form-control">
                        </div>
                    </form>

                </div>
                <!-- <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div> -->
            </div>
        </div>
    </div>

    <div class="layui-container">
        <table id="demo" lay-filter="test"></table>
    </div>

    <!-- 视图 -->
    <div id="editView" style="width: 560px; display: none;">
    </div>
    <!-- 列模板 -->
    <script type="text/html" id="barDemo">
        <a class="layui-btn layui-btn-xs" lay-event="detail">查看</a>
        <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>

        <!-- 这里同样支持 laytpl 语法，如： -->
        {{#  if(d.auth > 2){ }}
        <a class="layui-btn layui-btn-xs" lay-event="check">审核</a>
        {{#  } }}
    </script>
    <!-- 编辑表单模板 -->
    <script id="editViewTpl" type="text/html">
        <form class="layui-form" action="">
            <div class="layui-form-item">
                <label class="layui-form-label">用户名</label>
                <div class="layui-input-block">
                    <input type="text" name="username" required lay-verify="required" value="{{d.username}}"
                        autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">积分</label>
                <div class="layui-input-block">
                    <input type="text" name="experience" required lay-verify="required" value="{{d.experience}}"
                        autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">城市</label>
                <div class="layui-input-block">
                    <select name="city" lay-verify="required">
                        <option value="未选择"></option>
                        <option value="北京">北京</option>
                        <option value="上海">上海</option>
                        <option value="广州">广州</option>
                        <option value="深圳">深圳</option>
                        <option value="杭州">杭州</option>
                        <option value="郑州">郑州</option>
                        <option value="商丘">商丘</option>
                        <option value="洛阳">洛阳</option>
                        <option value="开封">开封</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">性别</label>
                <div class="layui-input-block">
                    {{#  if(d.sex === '男'){ }}
                    <input type="radio" name="sex" value="男" title="男" checked>
                    <input type="radio" name="sex" value="女" title="女">
                    {{#  } }}
                    {{#  if(d.sex === '女'){ }}
                    <input type="radio" name="sex" value="男" title="男">
                    <input type="radio" name="sex" value="女" title="女" checked>
                    {{#  } }}
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
                </div>
            </div>
        </form>
        </ul>
    </script>

    <script>
        layui.use(['layer', 'table', 'laytpl', 'form'], function () {
            var table = layui.table;
            var laytpl = layui.laytpl; //引入laytpl 模板引擎
            var form = layui.form; //表单引擎
            var $ = layui.jquery;
            var dataLength;
            $.get("http://localhost:3004/authors", function (abc) {
                dataLength = abc.length;
            })

            //第一个实例
            table.render({
                elem: '#demo',
                height: 480,
                url: 'http://localhost:3004/authors' //数据接口
                    ,
                parseData: function (res) { //res 即为原始返回的数据
                    return {
                        "code": 0, //解析接口状态
                        "msg": '', //解析提示文本
                        "count": dataLength, //解析数据长度
                        "data": res //解析数据列表
                    };
                },
                request: {
                    pageName: '_page' //页码的参数名称，默认：page
                        ,
                    limitName: '_limit' //每页数据量的参数名，默认：limit
                },
                page: {
                    limit: 6,
                    limits: [6, 10, 15, 20],
                    first: "首页",
                    last: "尾页",
                    // layout: ['count', 'limit', 'prev', 'page', 'skip']
                } //开启分页
                ,
                cols: [
                    [ //表头
                        {
                            field: 'sel',
                            title: '选择',
                            width: 50,
                            fixed: 'left',
                            type: 'checkbox',
                        },
                        {
                            field: 'id',
                            title: '序号',
                            width: 100,
                            sort: true,
                        }, {
                            field: 'username',
                            title: '用户名',
                            width: 80
                        }, {
                            field: 'sex',
                            title: '性别',
                            width: 80,
                            sort: true
                        }, {
                            field: 'city',
                            title: '城市',
                            width: 80
                        }, {
                            field: 'sign',
                            title: '签名',
                            width: 177
                        }, {
                            field: 'experience',
                            title: '积分',
                            width: 80,
                            sort: true
                        }, {
                            field: 'score',
                            title: '评分',
                            width: 80,
                            sort: true
                        }, {
                            field: 'classify',
                            title: '职业',
                            width: 80
                        }, {
                            field: 'wealth',
                            title: '财富',
                            width: 135,
                            sort: true,
                        },
                        {
                            field: 'anpai',
                            title: '安排',
                            width: 160,
                            align: 'center',
                            toolbar: '#barDemo'
                        }
                    ]
                ],
            });
            //监听工具条 
            table.on('tool(test)', function (obj) { //注：tool 是工具条事件名，test 是 table 原始容器的属性 lay-filter="对应的值"
                var data = obj.data; //获得当前行数据
                var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
                var tr = obj.tr; //获得当前行 tr 的 DOM 对象（如果有的话）
                console.log(data);
                if (layEvent === 'detail') { //查看
                    //do somehing
                } else if (layEvent === 'del') { //删除
                    layer.confirm('真的删除行么', function (index) {
                        obj.del(); //删除对应行（tr）的DOM结构，并更新缓存
                        layer.close(index);
                        //向服务端发送删除指令
                        $.ajax({
                            type: "delete",
                            url: "http://localhost:3004/authors/" + data.id,
                            success: function () {
                                $(".layui-laypage-btn").eq(0).click()
                            }
                            //?
                        })
                    });
                } else if (layEvent === 'edit') { //编辑

                    var getTpl = editViewTpl.innerHTML, //获取模板
                        view = document.getElementById('editView'); //获取视图
                    laytpl(getTpl).render(data, function (html) {
                        view.innerHTML = html;
                    });
                    //表单元素动态插入需要更新渲染
                    form.render();
                    //do something
                    var editOpen = layer.open({
                        type: 1,
                        area: ["600px"],
                        content: $(
                            '#editView'
                        ) //这里content是一个DOM，注意：最好该元素要存放在body最外层，否则可能被其它的相对元素所影响
                    });
                    //同步更新缓存对应的值
                    // obj.update({
                    //     username: '123',
                    //     title: 'xxx'
                    // });
                } else if (layEvent === 'LAYTABLE_TIPS') {
                    layer.alert('Hi，头部工具栏扩展的右侧图标。');
                }
                form.on('submit(formDemo)', function (d) {
                    console.log(d.elem) //被执行事件的元素DOM对象，一般为button对象
                    console.log(d.form) //被执行提交的form对象，一般在存在form标签时才会返回
                    console.log(d.field) //当前容器的全部表单字段，名值对形式：{name: value}
                    $.ajax({
                        type: "patch",
                        url: "http://localhost:3004/authors/" + data.id,
                        data: d.field,
                        success: function () {
                            layer.close(editOpen);
                            $(".layui-laypage-btn").click()
                        }
                    })
                    return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
                });
            });
            // 表单监听submit提交

        });
    </script>


    <!-- 尾部 -->
    <div class="container-fluid footer" style="position: relative; margin-top: 30px;">
        <div class="container">
            <ul class="row" style="margin-right: 0;">
                <div class="col-md-3 col-xs-6">
                    <div class="row">
                        <div class="col-xs-4">
                            <img src="./images/safe.png" alt="">
                        </div>
                        <div class="col-xs-8">
                            <h4>食品安全</h4>
                            <small>精选产品 严格质检</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-xs-6 line">
                    <div class="row">
                        <div class="col-xs-4">
                            <img src="./images/transport.png" alt="">
                        </div>
                        <div class="col-xs-8">
                            <h4>全城冷链</h4>
                            <small>可靠物流 安全可控</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-xs-6 line">
                    <div class="row">
                        <div class="col-xs-4">
                            <img src="./images/green.png" alt="">
                        </div>
                        <div class="col-xs-8">
                            <h4>绿色天然</h4>
                            <small>绿色生态 蔬果精选</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-xs-6 line">
                    <div class="row">
                        <div class="col-xs-4">
                            <img src="./images/quality.png" alt="">
                        </div>
                        <div class="col-xs-8">
                            <h4>产地直采</h4>
                            <small>限定产源 质量保证</small>
                        </div>
                    </div>
                </div>
            </ul>

            <hr>

            <div class="row text-center link">
                <ul class="col-xs-6 col-md-3 list-unstyled">
                    <h3>服务保障</h3>
                    <li>正品保证</li>
                    <li>7天无理由退换</li>
                    <li>退货返运费</li>
                    <li>7X15小时客户服务</li>
                    <hr>
                </ul>
                <ul class="col-xs-6 col-md-3 list-unstyled">
                    <h3>支付方式</h3>
                    <li>公司转账</li>
                    <li>货到付款</li>
                    <li>在线支付</li>
                    <li>分期付款</li>
                    <hr>
                </ul>
                <ul class="col-xs-6 col-md-3 list-unstyled">
                    <h3>商家服务</h3>
                    <li>培训中心</li>
                    <li>广告服务</li>
                    <li>服务市场</li>
                    <br>
                    <hr>
                </ul>
                <ul class="col-xs-6 col-md-3 list-unstyled">
                    <h3>服务保障</h3>
                    <li>免运费</li>
                    <li>海外配送</li>
                    <li>EMS</li>
                    <li>211限时达</li>
                    <hr>
                </ul>
            </div>
            <div class="row text-center" style="color: rgb(172, 172, 172);">
                <p>&copy;2016 果然新鲜 版权所有</p>
                <p><a href="" style="color: black;">手机版</a> | 本站使用bootstrop技术搭建 | <a
                        href="./layuimini/page/login-2.html" style="color: black;">管理登录</a>
                </p>
            </div>
        </div>
    </div>



</body>